% Remember to use the lgrind style

\Head{}
\File{getCard.cpp}{2016}{12}{6}{13:35}{1924}
\L{\LB{\K{\#include}_\S{}\3lab.h\3\SE{}}}
\L{\LB{\K{const}_\V{string}_\V{js}_=_\S{}\3Accept:_application/json\3\SE{};}}
\L{\LB{\K{const}_\V{string}_\V{key}_=_}}
\L{\LB{\S{}\3X\-Mashape\-Key:_q9bHltcHV2mshsWdmYro91TZDWyCp1vFXk8jsnHs80kSDWR3Co\3\SE{};}}
\L{\LB{}}
\index{getCard}\Proc{getCard}\L{\LB{\V{Card}_\V{getCard}(\V{string}_\V{query})}}
\L{\LB{\{}}
\L{\LB{}\Tab{4}{\V{Card}_\V{card};}}
\L{\LB{}\Tab{4}{\V{string}_\V{output};}}
\L{\LB{}\Tab{4}{}}
\L{\LB{}\Tab{4}{\K{struct}_\V{curl\_slist}_*\V{slist1}_=_\V{NULL};}}
\L{\LB{}\Tab{4}{\V{slist1}_=_\V{curl\_slist\_append}(\V{slist1},_\V{js}.\V{c\_str}());}}
\L{\LB{}\Tab{4}{\V{slist1}_=_\V{curl\_slist\_append}(\V{slist1},_\V{key}.\V{c\_str}());}}
\L{\LB{}\Tab{4}{}}
\L{\LB{}\Tab{4}{\V{string}_\V{cmd}_=_\S{}\3https://omgvamp\-hearthstone\-v1.p.mashape.com/cards/search/\3\SE{};}}
\L{\LB{}\Tab{4}{}}
\L{\LB{}\Tab{4}{\K{while}_(\V{query}.\V{find}(\S{}\3_\3\SE{})!=\V{string::npos})}}
\L{\LB{}\Tab{8}{\V{query}.\V{replace}(\V{query}.\V{find}(\S{}\3_\3\SE{}),_\N{1},_\S{}\3\%20\3\SE{});}}
\L{\LB{}\Tab{4}{}}
\L{\LB{}\Tab{4}{\V{string}_\V{search}_=_\V{cmd}_+_\V{query}_+_\S{}\3?collectible=1\3\SE{};}}
\L{\LB{}\Tab{4}{}}
\L{\LB{}\Tab{4}{\V{CURL}*_\V{handle}_=_\V{curl\_easy\_init}();}}
\L{\LB{}\Tab{4}{\V{curl\_easy\_setopt}(\V{handle},\V{CURLOPT\_URL},\V{search}.\V{c\_str}());}}
\L{\LB{}\Tab{4}{\V{curl\_easy\_setopt}(\V{handle},\V{CURLOPT\_HTTPHEADER},_\V{slist1});}}
\L{\LB{}\Tab{4}{\V{curl\_easy\_setopt}(\V{handle},\V{CURLOPT\_WRITEFUNCTION},\V{handleData});}}
\L{\LB{}\Tab{4}{\V{curl\_easy\_setopt}(\V{handle},\V{CURLOPT\_WRITEDATA},\&\V{output});}}
\L{\LB{}\Tab{4}{\V{curl\_easy\_perform}(\V{handle});}}
\L{\LB{}}
\L{\LB{}\Tab{4}{\K{while}_(!(\V{output}.\V{back}()_==_\S{}{'}\}{'}\SE{}\|\,\|\V{output}.\V{back}()_==_\S{}{'}]{'}\SE{})_)_\V{output}.\V{pop\_back}();}}
\L{\LB{}\Tab{4}{\C{}//cout_\<\<_output_\<\<_endl;\CE{}}}
\L{\LB{}}
\L{\LB{}\Tab{4}{\V{json}_\V{ji}_=_\V{json::parse}(\V{output});}}
\L{\LB{}\Tab{4}{\K{if}_(\V{output}.\V{find}(\S{}\3Card_not_found\3\SE{})_!=_\V{string::npos})\{}}
\L{\LB{}\Tab{8}{\V{cout}_\<\<_\S{}\3error_card_not_found\3\SE{}_\<\<_\V{endl};}}
\L{\LB{}\Tab{8}{\V{card}.\V{name}_=_\S{}\3error\3\SE{};}}
\L{\LB{}\Tab{4}{\}}}
\L{\LB{}\Tab{4}{\K{else}}}
\L{\LB{}\Tab{4}{\{}}
\L{\LB{}\Tab{8}{\K{if}_(!\V{ji}[\N{0}][\S{}\3name\3\SE{}].\V{is\_null}())_\V{card}.\V{name}_=_\V{ji}[\N{0}][\S{}\3name\3\SE{}];}}
\L{\LB{}\Tab{8}{\K{if}_(!\V{ji}[\N{0}][\S{}\3cardSet\3\SE{}].\V{is\_null}())_\V{card}.\V{cardSet}_=_\V{ji}[\N{0}][\S{}\3cardSet\3\SE{}];}}
\L{\LB{}\Tab{8}{\K{if}_(!\V{ji}[\N{0}][\S{}\3type\3\SE{}].\V{is\_null}())_\V{card}.\V{type}_=_\V{ji}[\N{0}][\S{}\3type\3\SE{}];}}
\L{\LB{}\Tab{8}{\K{if}_(!\V{ji}[\N{0}][\S{}\3text\3\SE{}].\V{is\_null}())_\V{card}.\V{text}_=_\V{ji}[\N{0}][\S{}\3text\3\SE{}];}}
\L{\LB{}\Tab{8}{\K{if}_(!\V{ji}[\N{0}][\S{}\3playerClass\3\SE{}].\V{is\_null}())}}
\L{\LB{}\Tab{12}{\V{card}.\V{playerClass}_=_\V{ji}[\N{0}][\S{}\3playerClass\3\SE{}];}}
\L{\LB{}\Tab{8}{\K{if}_(!\V{ji}[\N{0}][\S{}\3race\3\SE{}].\V{is\_null}())_\V{card}.\V{race}_=_\V{ji}[\N{0}][\S{}\3race\3\SE{}];}}
\L{\LB{}\Tab{8}{\K{if}_(!\V{ji}[\N{0}][\S{}\3img\3\SE{}].\V{is\_null}())_\V{card}.\V{img}_=_\V{ji}[\N{0}][\S{}\3img\3\SE{}];}}
\L{\LB{}\Tab{8}{\K{if}_(!\V{ji}[\N{0}][\S{}\3health\3\SE{}].\V{is\_null}())_\V{card}.\V{health}_=_\V{ji}[\N{0}][\S{}\3health\3\SE{}];}}
\L{\LB{}\Tab{8}{\K{if}_(!\V{ji}[\N{0}][\S{}\3attack\3\SE{}].\V{is\_null}())_\V{card}.\V{attack}_=_\V{ji}[\N{0}][\S{}\3attack\3\SE{}];}}
\L{\LB{}\Tab{8}{\K{if}_(!\V{ji}[\N{0}][\S{}\3durability\3\SE{}].\V{is\_null}())_}}
\L{\LB{}\Tab{12}{\V{card}.\V{durability}_=_\V{ji}[\N{0}][\S{}\3durability\3\SE{}];}}
\L{\LB{}\Tab{8}{\K{if}_(!\V{ji}[\N{0}][\S{}\3cost\3\SE{}].\V{is\_null}())_\V{card}.\V{cost}_=_\V{ji}[\N{0}][\S{}\3cost\3\SE{}];}}
\L{\LB{}\Tab{4}{\}}}
\L{\LB{}\Tab{4}{\K{return}_\V{card};}}
\L{\LB{\}}}
